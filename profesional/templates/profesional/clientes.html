{% extends 'profesional/base_home.html' %}
{% load static %}

{% block styles %}
<link rel="stylesheet" href="{% static 'profesional/css/clientes.css' %}">
{% endblock %}

{% block content %}
<!-- MAIN -->
<main>
	<div class="clientes-container">
		<div class="header-section">
			<h1 class="page-title">Clientes</h1>
			<div class="header-actions">
				<button class="btn-importar">Importar clientes</button>
				<button class="btn-agregar">Agregar cliente</button>
			</div>
		</div>

		{% if error %}
		<div class="alert alert-error">
			{{ error }}
		</div>
		{% endif %}

		<!-- Tabla de Clientes -->
		<div class="table-container">
			<table class="clientes-table">
				<thead>
					<tr>
						<th>
							Cliente
							<i class='bx bx-sort-alt-2'></i>
						</th>
						<th>
							Email
							<i class='bx bx-sort-alt-2'></i>
						</th>
						<th>
							Teléfono
							<i class='bx bx-sort-alt-2'></i>
						</th>
						<th>
							Última visita
							<i class='bx bx-sort-alt-2'></i>
						</th>
						<th>
							Siguiente visita
							<i class='bx bx-sort-alt-2'></i>
						</th>
					</tr>
				</thead>
				<tbody>
					{% if clientes %}
						{% for cliente in clientes %}
						<tr data-cliente-id="{{ cliente.id }}" data-relacion-id="{{ cliente.relacion_id }}">
							<td>{{ cliente.nombre_completo }}</td>
							<td>
								{% if cliente.email %}
									<span class="email-text">{{ cliente.email }}</span>
								{% else %}
									<a href="#" class="link-email" data-cliente-id="{{ cliente.id }}">Agregar email</a>
								{% endif %}
							</td>
							<td>
								{% if cliente.telefono %}
									{{ cliente.telefono }}
								{% else %}
									<span class="text-muted">Sin teléfono</span>
								{% endif %}
							</td>
							<td>
								{% if cliente.ultima_visita %}
									{{ cliente.ultima_visita|date:"d-m-Y H:i" }}
								{% else %}
									<span class="text-muted">Sin visitas</span>
								{% endif %}
							</td>
							<td>
								{% if cliente.proxima_visita %}
									{{ cliente.proxima_visita|date:"d-m-Y H:i" }}
								{% else %}
									<a href="#" class="link-cita" data-cliente-id="{{ cliente.id }}" data-relacion-id="{{ cliente.relacion_id }}">Crear cita</a>
								{% endif %}
							</td>
						</tr>
						{% endfor %}
					{% else %}
						<tr>
							<td colspan="5" class="no-data">
								No tienes clientes registrados aún
							</td>
						</tr>
					{% endif %}
				</tbody>
			</table>
		</div>
	</div>
</main>
<!-- MAIN -->
<!-- CONTENT -->
{% endblock %}

{% block scripts %}
<script src="{% static 'profesional/js/clientes.js' %}"></script>
{% endblock %}